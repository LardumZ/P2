% ¤¤ THANK YOU CLAUDE YOU THE GOAT ¤¤
\documentclass[a4paper,11pt,oneside,openright]{memoir}

% ¤¤ Document encoding and fonts ¤¤ %
\usepackage[T1]{fontenc}					% Output-indkodning af tegnsaet, dvs. printede fonte og tegn (T1 = Type 1 font med support for de fleste europaeiske sprog)
% Note: inputenc with utf8 is default in modern LaTeX, so removed

% ¤¤ Language and babel ¤¤ %
\usepackage[danish]{babel}					% Sproglig fremstilling af elementer (figur vs. figure, litteratur vs. bibliography osv.)

% ¤¤ Page layout and geometry ¤¤ %
\usepackage[a4paper]{geometry}
\usepackage{lscape}                         % Enkelte sider som landscape
\usepackage{pdflscape}

% ¤¤ SILENCE - Error suppression ¤¤ %
\usepackage{silence}
\WarningFilter{nameref}{The definition of}
\WarningFilter{BibTeX}{/tmp/biber_tmp}
% \hbadness=99999

% ¤¤ Text formatting and layout ¤¤ %
\usepackage{ragged2e,anyfontsize}			% Justering af elementer
\usepackage{icomma}                         % For komma som decimal seperator https://www.ctan.org/pkg/icomma
\usepackage{xurl}                           % meget bedre url til breaks
\usepackage[normalem]{ulem}
\usepackage{setspace}                       % env: spacing og func: \doublespacing, \onehalfspacing og \singlespacing

% ¤¤ Math packages ¤¤ %
\usepackage{amsmath} 		                % Avancerede matematik-udvidelser
\usepackage{amssymb}
\usepackage{mathabx}
\usepackage{scalerel}
\newcommand{\btdown}{\scalerel*{\blacktriangledown}{\blacktriangle}} % FUCK TRIANGLES ANDJISABDPASD IMMA COMMIT SEPPUKU
%\usepackage{wasysym}	            

%\usepackage{textcomp}                 		% Symbol-udvidelser (fx promille-tegn med \textperthousand)
\usepackage{siunitx}						% Flot og konsistent praesentation af tal og enheder med \si{enhed} og \SI{tal}{enhed}
\sisetup{output-decimal-marker = {,}}		% Opsaetning af \SI og decimalseparator
\sisetup{exponent-product = \cdot}
\sisetup{per-mode=fraction, fraction-function=\frac}

% ¤¤ Tables and arrays ¤¤ %
\usepackage{array, makecell}                % Combined array packages (removed duplicate)
\usepackage{diagbox}
\usepackage{slashbox}
\usepackage{pbox}
\usepackage{multirow}                		% Fletning af raekker og kolonner (\multicolumn og \multirow)
\usepackage{longtable}                      % Tabeller der kan være på forskellige sider
\usepackage{tabularx}                       % Introducere kolonne typen X (automatisk bredde justering)
\newcolumntype{Y}{>{\centering\arraybackslash}X}    % Samme som kolonne X men centreret
\usepackage{colortbl} 						% Farver i tabeller (fx \columncolor, \rowcolor og \cellcolor)
\usepackage{booktabs}

% ¤¤ Graphics and floats ¤¤ %
\usepackage{graphicx} 						% Inkludering af eksterne billeder (JPG, PNG, PDF)
\usepackage[dvipsnames,svgnames]{xcolor}	% Definer farver med \definecolor. Se mere: http://en.wikibooks.org/wiki/LaTeX/Colors
\usepackage{flafter}						% Soerger for, at floats ikke optraeder i teksten foer deres reference
\usepackage{float}							% Muliggoer eksakt placering af floats, fx \begin{figure}[H]
\let\newfloat\relax 						% Justering mellem float-pakken og memoir
\usepackage{wrapfig}						% Indsaettelse af figurer omsvoebt af tekst
\usepackage{subcaption}                     % figurer side by side

% ¤¤ TikZ and drawing ¤¤ %
\usepackage{tikz}                           % baggrund
\usetikzlibrary{shapes.geometric}
\usetikzlibrary{plotmarks}
\usetikzlibrary{matrix,fit,calc}
\usetikzlibrary{positioning,arrows.meta,calc}

% ¤¤ Bibliography ¤¤ %
\usepackage[natbib=false, backend=biber,sorting=nyt,style=apa]{biblatex}
\renewcommand*{\bibfont}{\fontsize{12}{12}\selectfont}
\setlength\bibitemsep{0.25\baselineskip}
\usepackage{csquotes}                       % problem med at den manglede i biblatex

% ¤¤ References ¤¤ %
\usepackage[danish]{varioref}				% Muliggoer bl.a. krydshenvisninger med sidetal (\vref) kunne man da også med \pageref ???

% ¤¤ Lists and enumeration ¤¤ %
\usepackage[shortlabels]{enumitem}			% Muliggoer enkelt konfiguration af lister (se \setlist nedenfor)

% ¤¤ Code listings ¤¤ %
\usepackage{listings}						% Placer kildekode i dokumentet med \begin{lstlisting}...\end{lstlisting}

% ¤¤ PDF inclusion ¤¤ %
\usepackage{pdfpages}						% Goer det muligt at inkludere pdf-dokumenter med kommandoen \includepdf[pages={x-y}]{fil.pdf}	   KAN OGSÅ LAVES TIL landscape med \includepdf[landscape=true]{circuit.pdf}
\pdfoptionpdfminorversion=6					% Muliggoer inkludering af pdf-dokumenter af version 1.6 og hoejere

% ¤¤ Miscellaneous packages ¤¤ %
\usepackage{lipsum}							% Dummy tekst med fx \lipsum[2]
\usepackage{blindtext}						% Dummy tekst med fx \blindtext[2]
\usepackage{mwe}
\usepackage{mdframed}
\usepackage{lastpage}
\usepackage[absolute]{textpos}
\usepackage{rotating}

% ¤¤ Array job for appendix handling ¤¤ %
\usepackage{arrayjob}
\usepackage{multido}

% ¤¤ Comments and corrections ¤¤ %
% Kommentarer og rettelser med \fxnote. Med 'final' i stedet for 'draft' udloeser hver note en error i den faerdige rapport.
\usepackage[footnote,draft,danish,silent,nomargin]{fixme}

% ¤¤ Glossaries (currently disabled due to memoir conflict) ¤¤ %
% problem med glossaries og memoior
\let\printglossary\relax
\let\theglossary\relax
\let\endtheglossary\relax
%\usepackage{glossaries}					    % Terminologi- eller symbolliste (se mere i Lars Madsens Latex-bog)
%\usepackage[automake]{glossaries-extra}

% ¤¤ HYPERREF - Must be loaded near the end ¤¤ %
\usepackage[colorlinks]{hyperref}			% Danner klikbare referencer (hyperlinks) i dokumentet
\hypersetup{colorlinks = true,				% Opsaetning af farvede hyperlinks (interne links, citeringer og URL)
    linkcolor = black,
    citecolor = black,
    urlcolor = black
}

\definecolor{gulny}{RGB}{255,192,0}

%%%% COLOR DEFINITIONS %%%%
% Definer farve til Bilag B
\definecolor{lillaB}{RGB}{170,114,212}
\definecolor{pinkB}{RGB}{248,139,193}
\definecolor{gulB}{RGB}{255,255,0}
\definecolor{blueB}{RGB}{0,112,192}
\definecolor{redB}{RGB}{192,0,0}
\definecolor{orangeB}{RGB}{245,102,23}
\definecolor{greenB}{RGB}{0,176,80}
\definecolor{greenlysB}{RGB}{124,155,30}

% AAU farver
\definecolor{aaublue}{RGB}{33,26,82}        % dark blue
\definecolor{numbercolor}{gray}{0.7}		% Definerer en farve til brug til kapiteludseende

% Listings colors
\definecolor{commentGreen}{RGB}{34,139,24}
\definecolor{stringPurple}{RGB}{208,76,239}

%%%% CUSTOM COMMANDS AND SYMBOLS %%%%
\newcommand{\blackbigcirc}{\tikz[baseline=-0.5ex] \fill (0,0) circle (1.1ex);} % cirkel med sort infill der bruges i HOQ

% Figure til morfanalyse
\newcommand{\lillacirc}{\tikz[baseline=-.6ex] \draw[violet, fill=violet] (0,0) circle (.8ex);}
\newcommand{\bluebox}{\tikz[baseline=-0ex] \draw[blue, fill=blue] (0,0) rectangle (1.4ex,1.4ex);}
\newcommand{\cyanbox}{\tikz[baseline=-0ex] \draw[cyan, fill=cyan]  (0,0.9ex) -- (0.9ex,1.8ex) -- (1.8ex,0.9ex) -- (0.9ex, 0) -- (0,0.9ex);}
\newcommand{\blueangle}{\tikz[baseline=-0ex] \draw[teal, fill=teal] (0,0.8ex) -- (1.6ex,1.6ex) -- (1.6ex,0);}
\newcommand{\greenangle}{\tikz[baseline=-0ex] \draw[green,fill=green] (0,0) -- (1.6ex,0.8ex) -- (0ex,1.6ex) ;}
\newcommand{\gulangle}{\tikz[baseline=-0.1ex] \draw[Goldenrod,fill=Goldenrod] (0,0) -- (1.6ex,0ex) -- (0.8ex,1.6ex) ;}
\newcommand{\orangeangle}{\tikz[baseline=-0.1ex] \draw[orange,fill=orange] (0, 1.6ex) -- (1.6ex,1.6ex) -- (0.8ex,0ex) ;}
\newcommand{\pinkstar}{\tikz[baseline=-0.8ex] \node[star,star points=5, fill=magenta, star point ratio = 0.1ex]  {~} ;}
\newcommand{\redkant}{\tikz[baseline=-0.8ex] \node[regular polygon, regular polygon sides=6, fill=red, scale = 0.18ex]  {~};} 

%nr. 11-19 (outline versions):
\newcommand{\lillacircny}{\tikz[line width=.6mm, baseline=-.6ex] \draw[violet] (0,0) circle (.6ex);}
\newcommand{\blueboxny}{\tikz[line width=.6mm, baseline=-0ex] \draw[blue] (0,0) rectangle (1.2ex,1.2ex);}
\newcommand{\cyanboxny }{\tikz[line width=.6mm, baseline=-0ex] \draw[cyan]  (0,0.8ex) -- (0.8ex,1.6ex) -- (1.6ex,0.8ex) -- (0.8ex, 0) -- (0,0.8ex) -- cycle;}
\newcommand{\blueangleny}{\tikz[line width=.5mm, baseline=-0ex] \draw[teal] (0,0.6ex) -- (1.2ex,1.2ex) -- (1.2ex,0) -- (0,0.6ex) -- cycle;}
\newcommand{\greenangleny}{\tikz[line width=.5mm, baseline=-0ex] \draw[green] (0,0) -- (1.2ex,0.6ex) -- (0ex,1.2ex) -- (0,0) -- cycle;}
\newcommand{\gulangleny}{\tikz[line width=.5mm, baseline=-0.1ex] \draw[Goldenrod] (0,0) -- (1.2ex,0ex) -- (0.6ex,1.2ex) -- cycle;}
\newcommand{\orangeangleny}{\tikz[line width=.5mm, baseline=-0.1ex] \draw[orange] (0, 1.2ex) -- (1.2ex,1.2ex) -- (0.6ex,0ex) -- cycle;}
\newcommand{\pinkstarny}{\tikz[line width=.4mm, baseline=-0.8ex] \node[star,star points=5,draw = magenta, star point ratio = 0.1ex, inner sep=3pt]  {~} ;}
\newcommand{\redkantnyy}{\tikz[line width=.6mm, baseline= .1ex] \draw[red] (0.5ex,0) -- (0,0.8ex) -- (0.5ex,1.6ex) -- (1.4ex,1.6ex) --(1.9ex,0.8ex) -- (1.4ex,0) -- cycle;}

% ¤¤ Specielle tegn ¤¤ %
\newcommand{\dec}{^{\circ}}									% '\dec' returnerer et gradtegn (husk $$ udenfor aligns)
\newcommand{\decC}{^{\circ}\text{C}}						% '\decC' returnerer et gradtegn + 'C' (husk $$ udenfor aligns)
\newcommand{\m}{\cdot}										% '\m' returnerer et gangetegn

\newcommand{\note}[1]{
    {\color{red} #1} \\
}

%%%% DOCUMENT SETUP %%%%
\pretolerance=2500 							% Justering af afstand mellem ord (hoejt tal, mindre orddeling og mere luft mellem ord)

% for at lave forside og titelblad nemmere og rigtig
\makeatletter
\let\thetitle\@title
\let\theauthor\@author
\let\thedate\@date
\makeatother

\newtoks\institution

%%%% COUNTERS AND ARRAYS %%%%
\makeatletter
\newcounter{authorlen}
\setcounter{authorlen}{0}
\foreach \i in \theauthor{
    \stepcounter{authorlen}
}
\makeatother

\newcounter{ExternAppendixCounter}
\setcounter{ExternAppendixCounter}{0}
\newarray\apendixExtern

%%%% CUSTOM LABELS %%%%
% https://tex.stackexchange.com/questions/18191/defining-custom-labels
\makeatletter
\newcommand{\customlabel}[2]{%
   \protected@write \@auxout {}{\string \newlabel {#1}{{#2}{\thepage}{#2}{#1}{}} }%
   \hypertarget{#1}{#2}%
}
\makeatother

\makeatletter
\newcommand{\apxlabel}[1]{%
   \protected@write \@auxout {}{\string \newlabel {#1}{{Bilag \thechapter}{\thepage}{Bilag \thechapter}{#1}{}} }%
   \hypertarget{#1}{}%
}
\makeatother

\makeatletter
\newcommand{\apxextern}[2]{%
   \addtocounter{ExternAppendixCounter}{1}
    \protected@write \@auxout {}{\string \newlabel {#1}{{Eksternt bilag ''\texttt{\MakeLowercase{#2}}''}{\thepage}{Eksternt bilag #2}{#1}{}} }%
   \hypertarget{#1}{}%
   \apendixExtern(\theExternAppendixCounter)={#2}
}
\makeatother

\newcommand{\printapxextern}{
    \ifnum \value{ExternAppendixCounter}=0
    \else
    Udover de inkluderede bilag består rapporten også af \ifnum \value{ExternAppendixCounter}=1 et eksternt bilag. Dette \else \theExternAppendixCounter\space eksterne bilag. Disse \fi bilag er
    \begin{itemize}
        \multido{\i=1+1}{\theExternAppendixCounter}{% 
        \item  \apendixExtern(\i)
        }
    \end{itemize}
    \fi
}

\makeatletter
\newcommand{\landscapepagenum}{
    \thispagestyle{empty}
    \textblockorigin{1.25\textheight}{45pt}
    \begin{textblock}{10}(0, 0)
        \turnbox{90}{\thepage}
    \end{textblock}
}
\makeatother

%%%% USER-DEFINED SETTINGS %%%%
\setsecnumdepth{subsection}		 	    % Dybden af nummerede overkrifter (part/chapter/section/subsection)

\setcounter{tocdepth}{1}
\setcounter{secnumdepth}{3}

% ¤¤ Marginer ¤¤ %
\setlrmarginsandblock{2.5cm}{2.5cm}{*}		% \setlrmarginsandblock{Indbinding}{Kant}{Ratio}
\setulmarginsandblock{2.5cm}{3.0cm}{*}		% \setulmarginsandblock{Top}{Bund}{Ratio}
\checkandfixthelayout 						% Oversaetter vaerdier til brug for andre pakker

%	¤¤ Afsnitsformatering ¤¤ %
\setlength{\parindent}{0mm}           		% Stoerrelse af indryk, skal bare være 0.
\setlength{\parskip}{3mm}          			% Afstand mellem afsnit ved brug af double Enter
\linespread{1,5}							% Linjeafstand

% ¤¤ Lister ¤¤ %
\setlist{
  topsep=0pt,								% Vertikal afstand mellem tekst og listen
  itemsep=-1ex,								% Vertikal afstand mellem items
} 

% ¤¤ Opsaetning af figur- og tabeltekst ¤¤ %
\captionnamefont{\small\bfseries\itshape}	% Opsaetning af tekstdelen ('Figur' eller 'Tabel')
\captiontitlefont{\small}					% Opsaetning af nummerering
\captiondelim{. }							% Seperator mellem nummerering og figurtekst
\captionstyle{\centering}					% Justering/placering af figurteksten (centreret = \centering, venstrejusteret = \raggedright)

\captionwidth{\linewidth}					% Bredden af figurteksten
\hangcaption								% Venstrejusterer fler-linjers figurtekst under hinanden
\setlength{\belowcaptionskip}{0pt}			% Afstand under figurteksten

% ¤¤ Opsaetning af listings ¤¤ %
\lstset{language=Matlab,					% Sprog
	basicstyle=\ttfamily\scriptsize,		% Opsaetning af teksten
	keywords={for,if,while,else,elseif,		% Noegleord at fremhaeve
			  end,break,return,case,
			  switch,function},
	keywordstyle=\color{blue},				% Opsaetning af noegleord
	commentstyle=\color{commentGreen},		% Opsaetning af kommentarer
	stringstyle=\color{stringPurple},		% Opsaetning af strenge
	showstringspaces=false,					% Mellemrum i strenge enten vist eller blanke
	numbers=left, numberstyle=\tiny,		% Linjenumre
	extendedchars=true, 					% Tillader specielle karakterer
	columns=flexible,						% Kolonnejustering
	breaklines, breakatwhitespace=true,		% Bryd lange linjer
}

% ¤¤ Navngivning ¤¤ %
\addto\captionsdanish{
	\renewcommand\contentsname{Indholdsfortegnelse}			% Skriver 'Indholdsfortegnelse' i stedet for 'Indhold'
	\renewcommand\appendixname{Bilag}					% Skriver 'Bilag' i stedet for 'Appendix'
	\renewcommand\appendixpagename{Appendix}
	\renewcommand\appendixtocname{Appendix}
	\renewcommand\cftchaptername{\chaptername~}				% Skriver 'Kapitel' foran kapitlerne i indholdsfortegnelsen
	\renewcommand\cftappendixname{\appendixname~}			% Skriver 'Appendiks' foran appendiks i indholdsfortegnelsen
    \renewcommand\figureautorefname{Figur}
    \renewcommand\tableautorefname{Tabel}
}

% ¤¤ Kapiteludssende ¤¤ %
\newif\ifchapternonum

\makechapterstyle{ntglike}{					% Definerer kapiteludseende frem til ...
  \renewcommand\beforechapskip{0pt}
  \renewcommand\printchaptername{}
  \renewcommand\printchapternum{}
  \renewcommand\printchapternonum{\chapternonumtrue}
  \renewcommand\chaptitlefont{\fontfamily{pbk}\fontseries{n}\fontshape{b}\fontsize{25}{35}\selectfont\raggedleft} % kan ændres fra n til db, jf. https://tex.stackexchange.com/questions/68745/possible-values-for-fontseries-and-fontshape 
  \renewcommand\chapnumfont{\fontfamily{pbk}\fontseries{m}\fontshape{n}\fontsize{1in}{0in}\selectfont\color{numbercolor}}
  \renewcommand\printchaptertitle[1]{%
    \noindent
    \ifchapternonum
    \begin{tabularx}{\textwidth}{X}
    {\let\\\newline\chaptitlefont ##1\par} 
    \end{tabularx}
    \par\vskip-2.5mm\hrule
    \else
    \begin{tabularx}{\textwidth}{Xl}
    {\parbox[b]{\linewidth}{\chaptitlefont ##1}} & \raisebox{-15pt}{\chapnumfont \thechapter}
    \end{tabularx}
    \par\vskip2mm\hrule
    \fi
  }
}											% ... her

\chapterstyle{ntglike}						% Valg af kapiteludseende - Google 'memoir chapter styles' for alternativer

% ¤¤ Sidehoved/sidefod ¤¤ %
\makepagestyle{Uni}							% Definerer sidehoved og sidefod udseende frem til ...
\makepsmarks{Uni}{%
	\createmark{chapter}{left}{shownumber}{}{. \ }
	\createmark{section}{right}{shownumber}{}{. \ }
	\createplainmark{toc}{both}{\contentsname}
	\createplainmark{lof}{both}{\listfigurename}
	\createplainmark{lot}{both}{\listtablename}
	\createplainmark{bib}{both}{\bibname}
	\createplainmark{index}{both}{\indexname}
	\createplainmark{glossary}{both}{\glossaryname}
}
\nouppercaseheads											% Ingen Caps oenskes

\makeevenhead{Uni}{Group xxx}{}{\leftmark}				% Lige siders sidehoved (\makeevenhead{Navn}{Venstre}{Center}{Hoejre})
\makeoddhead{Uni}{\rightmark}{}{Aalborg Universitet}			% Ulige siders sidehoved (\makeoddhead{Navn}{Venstre}{Center}{Hoejre})
\makeevenfoot{Uni}{\thepage \hspace{1pt} af}{}{}							% Lige siders sidefod (\makeevenfoot{Navn}{Venstre}{Center}{Hoejre})
\makeoddfoot{Uni}{}{}{\thepage \hspace{1pt} af \pageref{chap:endOfRapport}}								% Ulige siders sidefod (\makeoddfoot{Navn}{Venstre}{Center}{Hoejre})
\makeheadrule{Uni}{\textwidth}{0.5pt}						% Tilfoejer en streg under sidehovedets indhold
\makefootrule{Uni}{\textwidth}{0.5pt}{1mm}					% Tilfoejer en streg under sidefodens indhold

\copypagestyle{Unichap}{Uni}								% Der dannes en ny style til kapitelsider
\makeoddhead{Unichap}{}{}{}									% Sidehoved defineres som blank på kapitelsider
\makeevenhead{Unichap}{}{}{}
\makeheadrule{Unichap}{\textwidth}{0pt}
\aliaspagestyle{chapter}{Unichap}							% Den ny style vaelges til at gaelde for chapters
															% ... her
														
%\pagestyle{Uni}												% Valg af sidehoved og sidefod (benyt 'plain' for ingen sidehoved/fod)

% ¤¤ Sidehoved/sidefod - totalsider ¤¤ %
\makepagestyle{Unifront}							% Definerer sidehoved og sidefod udseende frem til ...
\makepsmarks{Unifront}{%
	\createmark{chapter}{left}{shownumber}{}{. \ }
	\createmark{section}{right}{shownumber}{}{. \ }
	\createplainmark{toc}{both}{\contentsname}
	\createplainmark{lof}{both}{\listfigurename}
	\createplainmark{lot}{both}{\listtablename}
	\createplainmark{bib}{both}{\bibname}
	\createplainmark{index}{both}{\indexname}
	\createplainmark{glossary}{both}{\glossaryname}
}
\nouppercaseheads											% Ingen Caps oenskes

\makeevenhead{Unifront}{}{}{}				% Lige siders sidehoved (\makeevenhead{Navn}{Venstre}{Center}{Hoejre})
\makeoddhead{Unifront}{}{}{}			% Ulige siders sidehoved (\makeoddhead{Navn}{Venstre}{Center}{Hoejre})
\makeevenfoot{Unifront}{\thepage \hspace{1pt}}{}{}							% Lige siders sidefod (\makeevenfoot{Navn}{Venstre}{Center}{Hoejre})
\makeoddfoot{Unifront}{}{}{\thepage \hspace{1pt}}								% Ulige siders sidefod (\makeoddfoot{Navn}{Venstre}{Center}{Hoejre})
%\makeheadrule{Unifront}{\textwidth}{0.5pt}						% Tilfoejer en streg under sidehovedets indhold
\makefootrule{Unifront}{\textwidth}{0.5pt}{1mm}					% Tilfoejer en streg under sidefodens indhold

\copypagestyle{Unifrontchap}{Unifront}								% Der dannes en ny style til kapitelsider
\makeoddhead{Unifrontchap}{}{}{}									% Sidehoved defineres som blank på kapitelsider
\makeevenhead{Unifrontchap}{}{}{}
\makeheadrule{Unifrontchap}{\textwidth}{0pt}
%\aliaspagestyle{chapter}{Unifrontchap}							% Den ny style vaelges til at gaelde for chapters
															% ... her
% NB: Istedet for at gøre dette her gøres dette i main ved start af apendix. Det er helt klart ikke den rigtige måde at gøre det på, men,
% https://tex.stackexchange.com/questions/198506/two-distinct-aliaspagestyles-for-a-document-or-another-solution-to-pagenumberin
               
%\pagestyle{Uni}												% Valg af sidehoved og sidefod (benyt 'plain' for ingen sidehoved/fod)

\AtBeginDocument{\addtocontents{toc}{\protect\thispagestyle{empty}}} 

%%%% ORDDELING %%%%
\hyphenation{In-te-res-se e-le-ment}